
# MSEDDI
MSEDDI: multi-scale embedding for predicting drug-drug interaction events
## Dataset
- event.db contains the data we compiled from [DrugBank](https://www.drugbank.ca/) 5.1.3 verision. It has 4 tables:  
**1.drug** contains 572 kinds of drugs and their features.  
**2.event** contains the 37264 DDIs between the 572 kinds of drugs.  
**3.extraction** is the process result of *NLPProcess*. Each interaction is transformed to a tuple: *{mechanism, action, drugA, drugB}*  
**4.event_numer** lists the kinds of DDI events and their occurence frequency.  
- db1_drugs.csv contains 4 columns: id,name,smiles,fpt, which means drugbank id, drug name, SMILES and fingerprint.
- db1_drugs.smiles contains 572 SMILES of drugs.
- db1_events.csv contains the names and numbers of 65 events.
- db1_triplets.csv contains 74,528 DDIs, which are represented as drug,drug,label.
- db2_ddi.csv contains 5 columns: index,mechanism,action,drugA,drugB, which means sample order, mechanism of event, action of event, first drug in DDI, second drug in DDI.
- db2_drugs.csv contains 4 columns: id,name,smiles,fpt, which means drugbank id, drug name, SMILES and fingerprint.
- db2_drugs.smiles contains 1258 SMILES of drugs.
- db2_events.csv contains the names and numbers of 100 events.
- db2_triplets.csv contains 323,539 DDIs, which are represented as drug,drug,label.
## feature files
- *_afp_pcba.pkl: chemical structure graph embedding generated by AttentiveFP model.
- *_kges_transe.pkl: knowledge graph embedding calculated by TransE algorithm.
- *_mpnn_pcba.pkl: chemical structure graph embedding generated by MPNN model.
- *_smiles_vec.pkl: SMILES notation embedding calculated by word2vec.
- *_weave_pcba.pkl: chemical structure graph embedding generated by Weave model.
## code files
- custom_metrics.py: calculation method of evaluation metrics.
- data_preprocessing.py: the process that all kinds of feature derived from raw data.
- ddi_datasets.py: data structure deformation before input to the model.
- loss.py: loss functions.
- models.py: MSEDDI model.
- train_case_study.py: the entrance of main program.
- train_cold_start.py: the entrance of case study program.
## Requirement
- numpy=1.22.4
- pandas=1.4.2
- python=3.8.13
- scikit-learn=1.0.2
- torch=1.11.0+cu113
- torchaudio=0.11.0+cu113
- torchvision=0.12.0+cu113  
Use the following command to install all dependencies. 
```
    pip install requirement.txt
```
## Usage
*Example Usage*
```
    python train_cold_start.py
```
If you want to reproduct the case study, please run the other entrance:
```
    python train_case_study.py
```
## Web service
http://121.36.221.79/MSEDDI/
